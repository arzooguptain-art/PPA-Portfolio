---
title: "Lab 0: Getting Started with dplyr"
subtitle: "Your First Data Analysis"
author: "Arzoo"
date: today
format: 
  html:
    code-fold: false
    toc: true
    toc-location: left
    theme: cosmo
execute:
  warning: false
  message: false
editor: 
  markdown: 
    wrap: 72
---

# Overview

This is the first lab, which is an exploratory exercise that introduced
me to

-   Basic data exploration
-   Column selection and manipulation\
-   Creating new variables
-   Filtering data
-   Grouping and summarizing

This also helped me get comfortable with building the github website and
how to put together the folder structure.

# Setup

```{r setup}
# Load the tidyverse library
library(tidyverse)

# Read in the car sales data
# Make sure the data file is in your lab_0/data/ folder
car_data <- read_csv("data/car_sales_data.csv")
```

# Exercise 1: Getting to Know Your Data

## 1.1 Data Structure Exploration

Explore the structure of your data and answer these questions:

```{r explore-structure}
# Use glimpse() to see the data structure
glimpse(car_data)

# Check the column names
names(car_data)

# Look at the first few rows
head(car_data)
```

**Questions to answer:** - How many rows and columns does the dataset
have? - What types of variables do you see (numeric, character, etc.)? -
Are there any column names that might cause problems? Why?

**Answers:** -

1.  Rows: 50,000

2.  Columns: 7\

    -   Variable types:

    Character and Numeric

3.  Problematic names: Engine Size, Fuel Type, Year of Manufacture, this
    is because they have spaces in the titles and R has trouble reading
    space, without an underscore, it becomes hard to conduct analysis on
    these columns easily as R may struggle to read them.

## 1.2 Tibble vs Data Frame

Compare how tibbles and data frames display:

```{r tibble-vs-dataframe}
# Look at the tibble version (what we have)
car_data

# Convert to regular data frame and display
car_df <- as.data.frame(car_data)
car_df
```

**Question:** What differences do you notice in how they print?

**Answer:** The Data Frame presents all the information and makes it
hard to read, where as the tibbles shows only ten rows at a time in a
scroll-able format. The Tibble format is easier and cleaner to perceive
visually and doesn't take up space on the document and make it extremely
long.

# Exercise 2: Basic Column Operations

## 2.1 Selecting Columns

Practice selecting different combinations of columns:

```{r column-selection}
# Select just Model and Mileage columns
car_data %>% 
  select(Mileage, Model)


# Select Manufacturer, Price, and Fuel type
car_data %>% 
  select(Manufacturer, Price, `Fuel type`)


# Challenge: Select all columns EXCEPT Engine Size
 car_data %>% 
  select (-`Engine size`)

```

## 2.2 Renaming Columns

Let's fix a problematic column name:

```{r rename-columns}
# Rename 'Year of manufacture' to year
car_data <- car_data %>% 
  rename( Year = `Year of manufacture`, Size = `Engine size` , Fuel = `Fuel type`)



# Check that it worked
names(car_data)
```

**Question:** Why did we need backticks around `Year of manufacture` but
not around `year`?

**Answer:** The backticks help R read the space in the column names and
makes it analysable whereas Year has no spaces sin the name of the
column.

# Exercise 3: Creating New Columns

## 3.1 Calculate Car Age

```{r calculate-age}
# Create an 'age' column (2025 minus year of manufacture)
car_data<- car_data %>% 
  mutate( age = (2025- Year))


# Create a mileage_per_year column  
car_data <- car_data %>% 
  mutate ( mileage_per_year = Mileage/ Year)


# Look at your new columns
names(car_data)

#select(car_data, Model, year, age, Mileage, mileage_per_year)
car_data %>% 
  select( Model, Year, age, Mileage, mileage_per_year)

```

## 3.2 Categorize Cars

```{r categorize-cars}
# Create a price_category column where if price is < 15000, its is coded as budget, between 15000 and 30000 is midrange and greater than 30000 is mid-range (use case_when)


car_data <- car_data %>% 
  mutate( price_category = case_when( Price < 15000 ~ "budget",
      Price >= 15000 & Price < 30000 ~ "midrange",
      Price >= 30000 ~ "luxury"))


# Check your categories select the new column and show it

car_data %>% 
  select( Model, Price, price_category)
```

# Exercise 4: Filtering Practice

## 4.1 Basic Filtering

```{r basic-filtering}
# Find all Toyota cars
toyota_car <- car_data %>% 
  filter( Manufacturer == "Toyota")

toyota_car

# Find cars with mileage less than 30,000
low_mileage <- car_data %>% 
  filter ( Mileage < 30000)

low_mileage

# Find luxury cars (from price category) with low mileage
high_value_cars <- car_data %>% 
  filter( Mileage < 30000 & price_category == "luxury")

high_value_cars

```

## 4.2 Multiple Conditions

```{r multiple-conditions}
# Find cars that are EITHER Honda OR Nissan
car_data %>% 
  filter( Manufacturer == "Honda" | Manufacturer == "Nissan")


# Find cars with price between $20,000 and $35,000
car_data %>% 
  filter ( Price >= 20000 & Price <= 35000)


# Find diesel cars less than 10 years old

car_data %>% 
  filter( Fuel == "Diesel" & age < 10)

```

**Question:** How many diesel cars are less than 10 years old?

**Answer:** 2040 Cars

# Exercise 5: Grouping and Summarizing

## 5.1 Basic Summaries

```{r basic-summaries}
# Calculate average price by manufacturer
avg_price_by_brand <- car_data %>%
  group_by(Manufacturer) %>%
  summarize(avg_price = mean(Price, na.rm = TRUE))

avg_price_by_brand

# Calculate average mileage by fuel type

avg_mileage_by_fuel <- car_data %>% 
  group_by (Fuel) %>% 
  summarise( avg_mileage = mean(Mileage , na.rm = T))

avg_mileage_by_fuel


# Count cars by manufacturer
no_cars_manufacturer <- car_data %>% 
 count(Manufacturer, name = "Cars")
no_cars_manufacturer

```

## 5.2 Categorical Summaries

```{r categorical-summaries}
# Frequency table for price categories
car_data %>%
  count(price_category , name = "Cars") %>%
  mutate(Percentage = Cars / sum( Cars) * 100)


```
